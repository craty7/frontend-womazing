{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/hp/Desktop/JavaScript (05.11.2022)/project clothes shop(18.03.2023)/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/hp/Desktop/JavaScript (05.11.2022)/project clothes shop(18.03.2023)/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/hp/Desktop/JavaScript (05.11.2022)/project clothes shop(18.03.2023)/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/hp/Desktop/JavaScript (05.11.2022)/project clothes shop(18.03.2023)/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useState}from'react';import axios from\"axios\";import{UserContext}from\"../../App\";import{useNavigate}from\"react-router-dom\";import{toast}from\"react-toastify\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function SignUpForm(props){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),email=_useState4[0],setEmail=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),password=_useState6[0],setPassword=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),cpassword=_useState8[0],setCpassword=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),data=_useState10[0],setData=_useState10[1];var navigate=useNavigate();var _useContext=useContext(UserContext),setUser=_useContext.setUser,setRef=_useContext.setRef;function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();if(!(password===cpassword)){_context.next=10;break;}_context.next=4;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/local/register\"),{username:username,email:email,password:password}).then(function(result){// document.cookie = `jwt=${result.data.jwt}` // document.cookie - внутри куки создает ключ 'jwt'\n// document.cookie = `active=${true}`\nlocalStorage.setItem('active','true');localStorage.setItem('jwt',result.data.jwt);localStorage.setItem('user',JSON.stringify(result.data.user));// так как внутри user хранится объект (массив), нужно хранить в JSON\n// npm i react-toastify --legacy-peer-deps\ntoast.success('Вы успешно зарегистрировали новый аккаунт!',{position:\"top-center\",autoClose:2000,hideProgressBar:true});navigate('/');setRef(true);setUser(function(prev){return _objectSpread(_objectSpread({},prev),{},{jwt:result.data.jwt,active:true,username:result.data.username,id:result.data.id});});console.log(result);setData(result);}).catch(function(e){console.log(e);});case 4:console.log(data);setUsername('');setEmail('');setPassword('');setCpassword('');return _context.abrupt(\"return\");case 10:alert('Ваши пароли не совпадают');case 11:case\"end\":return _context.stop();}},_callee);}));return _handleSubmit.apply(this,arguments);}return/*#__PURE__*/_jsx(\"div\",{className:\"box px-6 py-4\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Username...\",className:\"input my-1\",value:username,onInput:function onInput(e){return setUsername(e.target.value);},required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Email...\",className:\"input my-1\",value:email,onInput:function onInput(e){return setEmail(e.target.value);},required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password...\",className:\"input my-1\",value:password,onInput:function onInput(e){return setPassword(e.target.value);},required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Confirm password...\",className:\"input my-1\",value:cpassword,onInput:function onInput(e){return setCpassword(e.target.value);},required:true}),/*#__PURE__*/_jsx(\"button\",{style:{backgroundColor:'#509498'},className:\"button mt-4 has-text-white\",children:\"Register\"})]})});}export default SignUpForm;","map":{"version":3,"names":["React","useContext","useState","axios","UserContext","useNavigate","toast","jsx","_jsx","jsxs","_jsxs","SignUpForm","props","_useState","_useState2","_slicedToArray","username","setUsername","_useState3","_useState4","email","setEmail","_useState5","_useState6","password","setPassword","_useState7","_useState8","cpassword","setCpassword","_useState9","_useState10","data","setData","navigate","_useContext","setUser","setRef","handleSubmit","_x","_handleSubmit","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","wrap","_callee$","_context","prev","next","preventDefault","post","concat","process","env","REACT_APP_API_URL","then","result","localStorage","setItem","jwt","JSON","stringify","user","success","position","autoClose","hideProgressBar","_objectSpread","active","id","console","log","catch","e","abrupt","alert","stop","className","children","onSubmit","type","placeholder","value","onInput","target","required","style","backgroundColor"],"sources":["C:/Users/hp/Desktop/JavaScript (05.11.2022)/project clothes shop(18.03.2023)/frontend/src/components/SignUpForm/SignUpForm.jsx"],"sourcesContent":["import React, {useContext, useState} from 'react';\nimport axios from \"axios\"\nimport {UserContext} from \"../../App\";\nimport {useNavigate} from \"react-router-dom\";\nimport {toast} from \"react-toastify\";\n\nfunction SignUpForm(props) {\n    const [username, setUsername] = useState('')\n    const [email, setEmail] = useState('')\n    const [password, setPassword] = useState('')\n    const [cpassword, setCpassword] = useState('')\n    const [data, setData] = useState(null)\n    const navigate = useNavigate()\n    const {setUser, setRef} = useContext(UserContext)\n\n    async function handleSubmit(event) {\n        event.preventDefault()\n        if (password === cpassword) {\n            await axios.post(`${process.env.REACT_APP_API_URL}/auth/local/register`, {\n                        username: username,\n                        email: email,\n                        password: password\n                    })\n                .then(result => {\n                        // document.cookie = `jwt=${result.data.jwt}` // document.cookie - внутри куки создает ключ 'jwt'\n                        // document.cookie = `active=${true}`\n\n                        localStorage.setItem('active', 'true')\n                        localStorage.setItem('jwt', result.data.jwt)\n                        localStorage.setItem('user', JSON.stringify(result.data.user)) // так как внутри user хранится объект (массив), нужно хранить в JSON\n\n                        // npm i react-toastify --legacy-peer-deps\n\n                        toast.success('Вы успешно зарегистрировали новый аккаунт!', {\n                            position: \"top-center\",\n                            autoClose: 2000,\n                            hideProgressBar: true\n                        })\n\n                        navigate('/')\n                        setRef(true)\n                        setUser(prev => {\n                            return {\n                                ...prev,\n                                jwt: result.data.jwt,\n                                active: true,\n                                username: result.data.username,\n                                id: result.data.id\n                            }\n                        })\n                    console.log(result)\n                    setData(result)\n                }).catch(e => {\n                    console.log(e)\n                })\n            console.log(data)\n\n            setUsername('')\n            setEmail('')\n            setPassword('')\n            setCpassword('')\n            return\n        }\n        alert('Ваши пароли не совпадают')\n    }\n\n\n    return (\n        <div className='box px-6 py-4'>\n                <form onSubmit={handleSubmit}>\n                    <input\n                        type=\"text\"\n                        placeholder='Username...'\n                        className='input my-1'\n                        value={username}\n                        onInput={e => setUsername(e.target.value)}\n                        required={true}/>\n\n                    <input type=\"email\"\n                           placeholder='Email...'\n                           className='input my-1'\n                           value={email}\n                           onInput={e => setEmail(e.target.value)}\n                           required={true}/>\n\n                    <input type=\"password\"\n                           placeholder='Password...'\n                           className='input my-1'\n                           value={password}\n                           onInput={e => setPassword(e.target.value)}\n                           required={true}/>\n\n                    <input type=\"password\"\n                           placeholder='Confirm password...'\n                           className='input my-1'\n                           value={cpassword}\n                           onInput={e => setCpassword(e.target.value)}\n                           required={true}/>\n                    <button style={{backgroundColor: '#509498'}} className='button mt-4 has-text-white'>Register</button>\n                </form>\n            </div>\n    );\n}\n\nexport default SignUpForm;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}