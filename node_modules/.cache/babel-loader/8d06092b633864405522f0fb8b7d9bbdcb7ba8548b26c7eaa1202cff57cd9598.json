{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hp\\\\Desktop\\\\JavaScript (05.11.2022)\\\\project clothes shop(18.03.2023)\\\\frontend\\\\src\\\\components\\\\SignInForm\\\\SignInForm.jsx\",\n  _s = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from 'react';\nimport axios from \"axios\";\nimport { UserContext } from \"../../App\";\nimport { useNavigate } from \"react-router-dom\";\nimport { toast } from \"react-toastify\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction SignInForm(props) {\n  _s();\n  const [email, setEmail] = useState('');\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState(false);\n  const navigate = useNavigate();\n  const {\n    user,\n    setUser,\n    setRef\n  } = useContext(UserContext);\n  useEffect(() => {\n    error && alert('Неправильные данные');\n  }, [error]);\n  async function handleSubmit(e) {\n    e.preventDefault();\n    if (username && password) {\n      await axios.post(`${process.env.REACT_APP_API_URL}/auth/local`, {\n        identifier: username,\n        password: password\n      }).then(res => {\n        toAuth();\n        document.cookie = `jwt=${res.data.jwt}`; // document.cookie - внутри куки создает ключ 'jwt'\n        document.cookie = `active=${true}`;\n        localStorage.setItem('jwt', res.data.jwt);\n        localStorage.setItem('active', 'true');\n        localStorage.setItem('user', JSON.stringify(res.data.user));\n        toast.success('Вы успешно вошли в аккаунт!', {\n          position: \"top-center\",\n          autoClose: 2000,\n          hideProgressBar: true\n        });\n        setUser(prev => {\n          return {\n            ...prev,\n            jwt: res.data.jwt,\n            active: true\n          };\n        });\n        navigate('/');\n        setRef(false);\n      }).catch(e => setError(true));\n      setEmail('');\n      setUsername('');\n      setPassword('');\n      return;\n    }\n    alert('Заполните поля');\n  }\n  async function toAuth() {\n    await axios.put(`${process.env.REACT_APP_API_URL}/users/${user.user.id}`, {\n      role: 1\n    });\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"section\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"box px-6 py-4\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        action: \"\",\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"input my-1\",\n          type: \"text\",\n          onInput: event => setUsername(event.target.value),\n          value: username,\n          placeholder: \"Username...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"input my-1\",\n          type: \"password\",\n          onInput: event => setPassword(event.target.value),\n          value: password,\n          placeholder: \"Password...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            backgroundColor: '#509498'\n          },\n          className: \"button mt-4 has-text-white\",\n          children: \"Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 9\n  }, this);\n}\n_s(SignInForm, \"pbXIh3mKZmHzxUFfzbjhQ3YgGXI=\", false, function () {\n  return [useNavigate];\n});\n_c = SignInForm;\nexport default SignInForm;\n\n// чтобы хранил jwt при регистрации\nvar _c;\n$RefreshReg$(_c, \"SignInForm\");","map":{"version":3,"names":["React","useContext","useEffect","useState","axios","UserContext","useNavigate","toast","jsxDEV","_jsxDEV","SignInForm","props","_s","email","setEmail","username","setUsername","password","setPassword","error","setError","navigate","user","setUser","setRef","alert","handleSubmit","e","preventDefault","post","process","env","REACT_APP_API_URL","identifier","then","res","toAuth","document","cookie","data","jwt","localStorage","setItem","JSON","stringify","success","position","autoClose","hideProgressBar","prev","active","catch","put","id","role","className","children","action","onSubmit","type","onInput","event","target","value","placeholder","fileName","_jsxFileName","lineNumber","columnNumber","style","backgroundColor","_c","$RefreshReg$"],"sources":["C:/Users/hp/Desktop/JavaScript (05.11.2022)/project clothes shop(18.03.2023)/frontend/src/components/SignInForm/SignInForm.jsx"],"sourcesContent":["import React, {useContext, useEffect, useState} from 'react';\r\nimport axios from \"axios\";\r\nimport {UserContext} from \"../../App\";\r\nimport {useNavigate} from \"react-router-dom\";\r\nimport {toast} from \"react-toastify\";\r\n\r\n\r\nfunction SignInForm(props) {\r\n    const [email, setEmail] = useState('')\r\n    const [username, setUsername] = useState('')\r\n    const [password, setPassword] = useState('')\r\n    const [error, setError] = useState(false)\r\n    const navigate = useNavigate()\r\n    const {user, setUser, setRef} = useContext(UserContext)\r\n\r\n    useEffect(() => {\r\n        error && alert('Неправильные данные')\r\n    }, [error])\r\n\r\n    async function handleSubmit(e) {\r\n        e.preventDefault()\r\n        if (username && password) {\r\n            await axios.post(`${process.env.REACT_APP_API_URL}/auth/local`, {\r\n                identifier: username,\r\n                password: password,\r\n            }).then(\r\n                res => {\r\n                    toAuth()\r\n                    document.cookie = `jwt=${res.data.jwt}` // document.cookie - внутри куки создает ключ 'jwt'\r\n                    document.cookie = `active=${true}`\r\n                    localStorage.setItem('jwt', res.data.jwt)\r\n                    localStorage.setItem('active', 'true')\r\n                    localStorage.setItem('user', JSON.stringify(res.data.user))\r\n\r\n                    toast.success('Вы успешно вошли в аккаунт!', {\r\n                        position: \"top-center\",\r\n                        autoClose: 2000,\r\n                        hideProgressBar: true\r\n                    })\r\n\r\n                    setUser(prev => {\r\n                        return {\r\n                            ...prev,\r\n                            jwt: res.data.jwt,\r\n                            active: true\r\n                        }\r\n                    })\r\n                    navigate('/')\r\n                    setRef(false)\r\n                }\r\n            ).catch(e => setError(true))\r\n            setEmail('')\r\n            setUsername('')\r\n            setPassword('')\r\n            return\r\n       }\r\n       alert('Заполните поля')\r\n    }\r\n\r\n    async function toAuth() {\r\n        await axios.put(`${process.env.REACT_APP_API_URL}/users/${user.user.id}`, {\r\n            role: 1\r\n        })\r\n    }\r\n\r\n    return (\r\n        <div className='section'>\r\n            <div className='box px-6 py-4'>\r\n                <form action=\"\" onSubmit={handleSubmit}>\r\n                    <input className='input my-1' type=\"text\" onInput={event => setUsername(event.target.value)} value={username} placeholder='Username...'/>\r\n                    <input className='input my-1' type=\"password\" onInput={event => setPassword(event.target.value)} value={password} placeholder='Password...'/>\r\n                    <button style={{backgroundColor: '#509498'}} className='button mt-4 has-text-white'>Login</button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default SignInForm;\r\n\r\n// чтобы хранил jwt при регистрации"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}